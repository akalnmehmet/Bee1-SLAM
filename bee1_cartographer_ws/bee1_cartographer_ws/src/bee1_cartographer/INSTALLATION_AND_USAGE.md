# üêù Bee1-SLAM - Kurulum ve Kullanƒ±m Rehberi

![ROS2](https://img.shields.io/badge/ROS2-Humble-blue)
![License](https://img.shields.io/badge/License-Apache%202.0-green)
![Platform](https://img.shields.io/badge/Platform-Ubuntu%2022.04-orange)
![Docker](https://img.shields.io/badge/Docker-Supported-blue)

**üöó ROS2 SLAM & Navigation system for Bee1 autonomous vehicle**

## üìã **Sistem Gereksinimleri**

### Minimum Gereksinimler
- **ƒ∞≈ületim Sistemi:** Ubuntu 22.04 LTS
- **ROS2:** Humble Hawksbill
- **Python:** 3.10+
- **RAM:** Minimum 8GB (16GB √∂nerilir)
- **Depolama:** 50GB bo≈ü alan
- **Network:** Ethernet port (LiDAR i√ßin)

### √ñnerilen Donanƒ±m
- **ƒ∞≈ülemci:** Intel i7 veya AMD Ryzen 7
- **GPU:** NVIDIA RTX 3060 veya √ºzeri (CUDA desteƒüi)
- **RAM:** 16GB DDR4
- **SSD:** 100GB+ NVMe SSD
- **Donanƒ±m:** ADVANTECH end√ºstriyel bilgisayar

---

## 1. üöÄ Hƒ±zlƒ± Ba≈ülangƒ±√ß (√ñnerilen)

### 1.1 Otomatik Kurulum

```bash
# Kurulum scriptini indir ve √ßalƒ±≈ütƒ±r
curl -fsSL https://raw.githubusercontent.com/akalnmehmet/Bee1-SLAM/main/scripts/setup_bee1.sh -o setup_bee1.sh
chmod +x setup_bee1.sh
./setup_bee1.sh
```

Bu script otomatik olarak:
- ‚úÖ ROS2 Humble kurulumu
- ‚úÖ Gerekli t√ºm baƒüƒ±mlƒ±lƒ±klarƒ± y√ºkleme
- ‚úÖ Workspace olu≈üturma
- ‚úÖ Repository clone etme
- ‚úÖ Derleme ve konfig√ºrasyon

### 1.2 Docker ile Hƒ±zlƒ± Ba≈ülangƒ±√ß (Production)

```bash
# Repository clone
git clone https://github.com/akalnmehmet/Bee1-SLAM.git
cd Bee1-SLAM

# Docker Compose ile √ßalƒ±≈ütƒ±r
docker-compose up -d

# Container status kontrol√º
docker-compose ps
```

---

## 2. üîß Manuel Kurulum (Geli≈ütirici)

### 2.1 ROS2 Humble Kurulumu

```bash
# Locale ayarlarƒ±
sudo apt update && sudo apt install locales
sudo locale-gen en_US en_US.UTF-8
sudo update-locale LC_ALL=en_US.UTF-8 LANG=en_US.UTF-8
export LANG=en_US.UTF-8

# ROS2 GPG key ve repository
sudo apt install software-properties-common curl gnupg lsb-release
sudo add-apt-repository universe
sudo curl -sSL https://raw.githubusercontent.com/ros/rosdistro/master/ros.key -o /usr/share/keyrings/ros-archive-keyring.gpg
echo "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/ros-archive-keyring.gpg] http://packages.ros.org/ros2/ubuntu $(. /etc/os-release && echo $UBUNTU_CODENAME) main" | sudo tee /etc/apt/sources.list.d/ros2.list > /dev/null

# ROS2 Humble kurulum
sudo apt update && sudo apt upgrade
sudo apt install ros-humble-desktop
```

### 2.2 Bee1-SLAM Baƒüƒ±mlƒ±lƒ±klarƒ±

```bash
# Ana ROS2 paketleri
sudo apt install -y \
    ros-humble-cartographer \
    ros-humble-cartographer-ros \
    ros-humble-navigation2 \
    ros-humble-nav2-bringup \
    ros-humble-robot-localization \
    ros-humble-velodyne \
    ros-humble-velodyne-driver \
    ros-humble-velodyne-pointcloud \
    ros-humble-ublox \
    ros-humble-ublox-gps \
    ros-humble-xacro \
    ros-humble-joint-state-publisher \
    ros-humble-robot-state-publisher \
    ros-humble-tf2-tools \
    ros-humble-tf2-geometry-msgs \
    ros-humble-rqt-graph \
    ros-humble-rqt-robot-steering

# Python baƒüƒ±mlƒ±lƒ±klarƒ±
sudo apt install -y \
    python3-geojson \
    python3-pyproj \
    python3-colcon-common-extensions \
    python3-rosdep \
    python3-vcstool \
    python3-pip

# Ek sistem ara√ßlarƒ±
sudo apt install -y \
    git \
    wget \
    build-essential \
    libeigen3-dev \
    libgoogle-glog-dev \
    libgflags-dev \
    libatlas-base-dev \
    libsuitesparse-dev

# Python paketleri
pip3 install --user \
    numpy \
    scipy \
    matplotlib \
    pandas \
    pyyaml
```

### 2.3 Workspace Olu≈üturma ve Repository Clone

```bash
# Workspace dizini olu≈ütur
mkdir -p ~/bee1_cartographer_ws/src
cd ~/bee1_cartographer_ws

# rosdep ba≈ülat (ilk kez)
sudo rosdep init
rosdep update

# Environment setup
echo "source /opt/ros/humble/setup.bash" >> ~/.bashrc
source ~/.bashrc

# Repository clone
cd src
git clone https://github.com/akalnmehmet/Bee1-SLAM.git bee1_cartographer

# Baƒüƒ±mlƒ±lƒ±klarƒ± y√ºkle
cd ~/bee1_cartographer_ws
rosdep install --from-paths src --ignore-src -r -y

# Paketi derle
colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Release

# Workspace environment
source install/setup.bash
echo "source ~/bee1_cartographer_ws/install/setup.bash" >> ~/.bashrc
```

### 2.4 Dosya Yapƒ±sƒ± Doƒürulama

Kurulum sonrasƒ± dosya yapƒ±sƒ±nƒ± kontrol edin:

```bash
cd ~/bee1_cartographer_ws/src/bee1_cartographer

# Build sistemi
make build          # colcon build --symlink-install
make clean          # build/ install/ log/ temizle
make install        # Build + install
make test           # Testleri √ßalƒ±≈ütƒ±r

# Development
make format         # Code formatting
make lint           # Code linting
make docs           # Documentation olu≈ütur

# Docker
make docker-build   # Docker image build
make docker-run     # Docker container √ßalƒ±≈ütƒ±r
make docker-clean   # Docker cleanup

# System
make setup          # Sistem kurulumu
make deps           # Dependencies y√ºkle
make udev           # UDEV rules kur
```

---

## 12. üöÄ Production Deployment

### 12.1 Systemd Service Kurulumu

```bash
# Service dosyasƒ±nƒ± kopyala
sudo cp ~/bee1_cartographer_ws/src/bee1_cartographer/scripts/bee1_system.service /etc/systemd/system/

# Service dosyasƒ±nƒ± d√ºzenle (kullanƒ±cƒ± yolu ayarla)
sudo nano /etc/systemd/system/bee1_system.service

# Service'i etkinle≈ütir
sudo systemctl daemon-reload
sudo systemctl enable bee1_system.service

# Service'i ba≈ülat
sudo systemctl start bee1_system.service

# Service durumu
sudo systemctl status bee1_system.service

# Loglarƒ± kontrol et
sudo journalctl -u bee1_system.service -f
```

√ñrnek service dosyasƒ±:
```ini
[Unit]
Description=Bee1 SLAM & Navigation System
After=network.target
Wants=network.target

[Service]
Type=exec
User=bee1user
Group=bee1user
WorkingDirectory=/home/bee1user/bee1_cartographer_ws
Environment="ROS_DOMAIN_ID=0"
Environment="RMW_IMPLEMENTATION=rmw_cyclonedx_cpp"
ExecStartPre=/bin/bash -c "source /opt/ros/humble/setup.bash && source install/setup.bash"
ExecStart=/bin/bash -c "source /opt/ros/humble/setup.bash && source install/setup.bash && ros2 launch bee1_cartographer bee1_full_system.launch.py"
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

### 12.2 Auto-Start Konfig√ºrasyonu

```bash
# Boot time'da otomatik ba≈ülatma
sudo systemctl enable bee1_system.service

# Network baƒülantƒ±sƒ± sonrasƒ± ba≈ülatma
sudo nano /etc/systemd/system/bee1_system.service
# After=network-online.target ekle

# Kullanƒ±cƒ± login'i sonrasƒ± ba≈ülatma
systemctl --user enable bee1_system.service
```

### 12.3 Monitoring ve Logging

```bash
# Centralized logging
sudo mkdir -p /var/log/bee1
sudo chown $USER:$USER /var/log/bee1

# Log rotation konfig√ºrasyonu
sudo nano /etc/logrotate.d/bee1
```

Logrotate konfig√ºrasyonu:
```
/var/log/bee1/*.log {
    daily
    rotate 7
    compress
    delaycompress
    copytruncate
    create 644 bee1user bee1user
}
```

### 12.4 Performance Optimization

```bash
# CPU governor performance mode
echo 'performance' | sudo tee /sys/devices/system/cpu/cpu*/cpufreq/scaling_governor

# Network buffer optimization
sudo sysctl -w net.core.rmem_max=134217728
sudo sysctl -w net.core.rmem_default=134217728
sudo sysctl -w net.core.wmem_max=134217728
sudo sysctl -w net.core.wmem_default=134217728

# Real-time priority (dikkatli kullanƒ±n!)
sudo echo 'kernel.sched_rt_runtime_us = -1' >> /etc/sysctl.conf

# GPU memory optimization (NVIDIA)
sudo nvidia-persistenced --persistence-mode
```

---

## 13. üîÑ G√ºncelleme ve Bakƒ±m

### 13.1 Sistem G√ºncellemeleri

```bash
# ROS2 paketleri g√ºncelle
sudo apt update
sudo apt upgrade ros-humble-*

# Python dependencies g√ºncelle
pip3 install --upgrade --user -r requirements.txt

# System packages g√ºncelle
sudo apt update && sudo apt upgrade
```

### 13.2 Repository G√ºncellemeleri

```bash
cd ~/bee1_cartographer_ws/src/bee1_cartographer

# Mevcut deƒüi≈üiklikleri yedekle
git stash push -m "Local changes backup $(date)"

# Latest changes'ƒ± al
git pull origin main

# Conflicts varsa √ß√∂z
git status
git diff

# Workspace'i yeniden derle
cd ~/bee1_cartographer_ws
colcon build --symlink-install

# Stash'i geri getir (gerekirse)
git stash pop
```

### 13.3 Konfig√ºrasyon Yedekleme

```bash
# Tam sistem yedekleme
cd ~/bee1_cartographer_ws
tar -czf bee1_backup_$(date +%Y%m%d_%H%M%S).tar.gz \
  src/bee1_cartographer/config/ \
  src/bee1_cartographer/scripts/ \
  maps/ \
  install/

# Sadece konfig√ºrasyon yedekleme
tar -czf bee1_config_backup_$(date +%Y%m%d).tar.gz \
  src/bee1_cartographer/config/

# Maps yedekleme
cp -r maps/ bee1_maps_backup_$(date +%Y%m%d)/

# Cloud backup (opsiyonel)
rsync -avz bee1_backup_*.tar.gz user@backup-server:/backup/bee1/
```

### 13.4 Log Y√∂netimi

```bash
# Log dosyalarƒ±nƒ± temizle
sudo journalctl --vacuum-time=7d
sudo journalctl --vacuum-size=1G

# ROS2 log cleanup
rm -rf ~/.ros/log/*

# Custom log cleanup
find /var/log/bee1 -name "*.log" -mtime +7 -delete
```

---

## 14. üîê G√ºvenlik ve Performans

### 14.1 Emergency Procedures

```bash
# Acil durum - sistem durdurma
ros2 topic pub /emergency_stop std_msgs/msg/Bool "{data: true}" --once

# Hardware emergency stop
ros2 service call /hardware_interface/emergency_stop std_srvs/srv/Empty

# T√ºm ROS2 node'larƒ±nƒ± kapat
pkill -f ros2

# Systemd service'i durdur
sudo systemctl stop bee1_system.service
```

### 14.2 Safety Checks

```bash
# Sistem saƒülƒ±k kontrol√º
ros2 topic echo /diagnostics | grep -E "(ERROR|WARN)"

# Sensor health check
ros2 service call /system_monitor/health_check std_srvs/srv/Empty

# Vehicle safety status
ros2 topic echo /vehicle/safety_status --once

# Speed limiter test
ros2 param get /vehicle_controller max_linear_velocity
```

### 14.3 Security Hardening

```bash
# ROS2 security keystore (opsiyonel)
ros2 security create_keystore demo_keystore
ros2 security create_enclave demo_keystore /bee1_cartographer

# Network interface restriction
sudo iptables -A INPUT -p udp --dport 7400:7499 -s 192.168.1.0/24 -j ACCEPT
sudo iptables -A INPUT -p udp --dport 7400:7499 -j DROP

# User permissions
sudo adduser bee1operator
sudo usermod -a -G dialout,video bee1operator
```

---

## 15. üìö Geli≈ümi≈ü Kullanƒ±m

### 15.1 Custom Waypoint Generation

Python script ile waypoint olu≈üturma:
```python
#!/usr/bin/env python3
import json
import math

def generate_circular_waypoints(center_lat, center_lon, radius_m, num_points):
    """Generate circular waypoints"""
    waypoints = []
    
    for i in range(num_points):
        angle = 2 * math.pi * i / num_points
        
        # Approximate lat/lon offset (not precise for large distances)
        lat_offset = radius_m * math.cos(angle) / 111319.5
        lon_offset = radius_m * math.sin(angle) / (111319.5 * math.cos(math.radians(center_lat)))
        
        waypoint = {
            "type": "Feature",
            "properties": {
                "name": f"waypoint_{i}",
                "local_x": radius_m * math.cos(angle),
                "local_y": radius_m * math.sin(angle),
                "heading": math.degrees(angle + math.pi/2),
                "speed": 10.0,
                "stop_duration": 0.5
            },
            "geometry": {
                "type": "Point",
                "coordinates": [center_lon + lon_offset, center_lat + lat_offset]
            }
        }
        waypoints.append(waypoint)
    
    return {
        "type": "FeatureCollection",
        "features": waypoints
    }

# Kullanƒ±m
circular_mission = generate_circular_waypoints(40.7903314, 29.50896659, 50, 8)
with open("circular_track.geojson", "w") as f:
    json.dump(circular_mission, f, indent=2)
```

### 15.2 Real-time Parameter Tuning

```bash
# Cartographer parametrelerini canlƒ± deƒüi≈ütir
ros2 param set /cartographer_node trajectory_builder_2d.min_range 0.3
ros2 param set /cartographer_node trajectory_builder_2d.max_range 50.0

# Navigation parametreleri
ros2 param set /controller_server FollowPath.max_vel_x 10.0
ros2 param set /controller_server FollowPath.min_vel_x 2.0

# Safety parametreleri
ros2 param set /vehicle_controller emergency_brake_distance 5.0
```

### 15.3 Data Recording ve Analysis

```bash
# T√ºm veriyi kaydet
ros2 bag record -a -o bee1_mission_$(date +%Y%m%d_%H%M%S)

# Specific topics kaydet
ros2 bag record -o navigation_data \
  /scan /odom /tf /tf_static /gps/fix /imu/data \
  /cmd_vel /mission_status /diagnostics

# Bag dosyasƒ±nƒ± analiz et
ros2 bag info navigation_data.db3
ros2 bag play navigation_data.db3

# Data export (CSV)
python3 scripts/bag_to_csv.py navigation_data.db3
```

---

## 16. üÜò Sƒ±k√ßa Sorulan Sorular (FAQ)

### Kurulum ile ƒ∞lgili

**S: Workspace nerede olu≈üturulmalƒ±?**
A: `~/bee1_cartographer_ws` (home directory altƒ±nda)

**S: Hangi ROS2 daƒüƒ±tƒ±mƒ± kullanƒ±lmalƒ±?**
A: ROS2 Humble Hawksbill (Ubuntu 22.04 ile)

**S: Docker kullanmak zorunda mƒ±yƒ±m?**
A: Hayƒ±r, native kurulum da destekleniyor. Docker sadece deployment kolaylƒ±ƒüƒ± i√ßin.

### Donanƒ±m ile ƒ∞lgili

**S: Velodyne VLP16 baƒülantƒ± sorunu ya≈üƒ±yorum.**
A: Static IP konfig√ºrasyonunu kontrol edin (192.168.1.100/24) ve VLP16'ya ping atƒ±n (192.168.1.201).

**S: GPS fix alamƒ±yorum.**
A: A√ßƒ±k alanda olduƒüunuzdan ve antenna baƒülantƒ±sƒ±nƒ±n doƒüru olduƒüundan emin olun. /gps/fix topic'ini kontrol edin.

**S: IMU verisi gelmiyor.**
A: UDEV rules kurulumunu kontrol edin ve kullanƒ±cƒ±nƒ±n dialout grubunda olduƒüundan emin olun.

### Yazƒ±lƒ±m ile ƒ∞lgili

**S: Launch dosyalarƒ± ne i≈üe yarar?**
A: 
- `bee1_bringup.launch.py`: Temel sistem (robot model, EKF, sens√∂rler)
- `bee1_mapping.launch.py`: Haritalama modu
- `bee1_navigation.launch.py`: Navigasyon modu
- `bee1_full_system.launch.py`: Tam otonom sistem

**S: Mission executor neden √ßalƒ±≈ümƒ±yor?**
A: GeoJSON dosyasƒ±nƒ±n format kontrol√º yapƒ±n ve /mission_status topic'ini takip edin.

**S: Harita kalitesi d√º≈ü√ºk.**
A: Yava≈ü hareket edin, LiDAR temizliƒüini kontrol edin ve cartographer parametrelerini ayarlayƒ±n.

### Performance ile ƒ∞lgili

**S: Sistem yava≈ü √ßalƒ±≈üƒ±yor.**
A: CPU governor'ƒ± performance mode'a alƒ±n, sensor frequency'lerini d√º≈ü√ºr√ºn.

**S: Memory kullanƒ±mƒ± √ßok y√ºksek.**
A: Cartographer resolution'ƒ± artƒ±rƒ±n ve ROS2 daemon'ƒ± restart edin.

### G√ºvenlik ile ƒ∞lgili

**S: Emergency stop nasƒ±l kullanƒ±lƒ±r?**
A: `ros2 topic pub /emergency_stop std_msgs/msg/Bool "{data: true}" --once`

**S: Manuel override nasƒ±l aktif edilir?**
A: `/manual_override` topic'ini true yapƒ±n veya joystick kullanƒ±n.

**S: Maximum hƒ±z nedir?**
A: Yazƒ±lƒ±m limiti 15 m/s (55 km/h), g√ºvenlik i√ßin ayarlanabilir.

---

## 17. üìû Destek ve ƒ∞leti≈üim

### üêõ Problem Bildirimi

**GitHub Issues**: [https://github.com/akalnmehmet/Bee1-SLAM/issues](https://github.com/akalnmehmet/Bee1-SLAM/issues)

Issue olu≈ütururken ≈üunlarƒ± ekleyin:
- Ubuntu ve ROS2 versiyonlarƒ±
- Error log'larƒ±
- Reproduce steps
- Hardware konfig√ºrasyonu

### üí¨ Community Support

**GitHub Discussions**: [https://github.com/akalnmehmet/Bee1-SLAM/discussions](https://github.com/akalnmehmet/Bee1-SLAM/discussions)

### üìß Direct Contact

**Author**: Mehmet AKALIN  
**Email**: mehmetakalin660@gmail.com  
**LinkedIn**: [linkedin.com/in/mehmetakalin](https://linkedin.com/in/mehmetakalin)

### ü§ù Contributing

1. Fork repository: [https://github.com/akalnmehmet/Bee1-SLAM/fork](https://github.com/akalnmehmet/Bee1-SLAM/fork)
2. Feature branch olu≈ütur: `git checkout -b feature/amazing-feature`
3. Changes commit et: `git commit -m 'Add amazing feature'`
4. Branch'i push et: `git push origin feature/amazing-feature`
5. Pull Request olu≈ütur

### üìñ Additional Resources

- **ROS2 Documentation**: [https://docs.ros.org/en/humble/](https://docs.ros.org/en/humble/)
- **Cartographer**: [https://google-cartographer.readthedocs.io/](https://google-cartographer.readthedocs.io/)
- **Navigation2**: [https://navigation.ros.org/](https://navigation.ros.org/)
- **Velodyne Driver**: [https://github.com/ros-drivers/velodyne](https://github.com/ros-drivers/velodyne)

---

## üìà Version History

### v1.0.0 (Current)
- ‚úÖ Complete SLAM & Navigation system
- ‚úÖ Production-ready code
- ‚úÖ Docker support
- ‚úÖ Comprehensive documentation
- ‚úÖ Safety systems
- ‚úÖ Mission planning

### v0.9.0 (Beta)
- ‚úÖ Core functionality
- ‚úÖ Basic navigation
- ‚úÖ Sensor integration

### Roadmap v1.1.0
- üîÑ Multi-robot support
- üîÑ Advanced behavior trees
- üîÑ Machine learning integration
- üîÑ Cloud connectivity

---

**üöó Drive Autonomous, Drive Safe!** 

*Built with ‚ù§Ô∏è for autonomous racing and robotics research*

**¬© 2024 Mehmet AKALIN - Apache License 2.0**

---

## üìã Quick Reference Card

### üîß Essential Commands
```bash
# Quick start
./scripts/setup_bee1.sh

# Build
colcon build --symlink-install

# Full system
ros2 launch bee1_cartographer bee1_full_system.launch.py

# Emergency stop
ros2 topic pub /emergency_stop std_msgs/msg/Bool "{data: true}" --once

# Status check
ros2 topic echo /system_status
```

### üìÅ Important Paths
```
~/bee1_cartographer_ws/          # Main workspace
src/bee1_cartographer/           # Source code
maps/                           # Saved maps
install/setup.bash              # Environment setup
config/                         # Configuration files
```

### üéØ Key Topics
```
/scan                   # LiDAR data
/gps/fix               # GPS position
/imu/data              # IMU data
/odom                  # Odometry
/cmd_vel               # Velocity commands
/mission_status        # Mission state
/emergency_stop        # Emergency stop
```

Bu kapsamlƒ± rehber ile Bee1-SLAM sistemini ba≈üarƒ±yla kurabilir ve kullanabilirsiniz! üöÄographer
tree -L 3
```

Beklenen yapƒ±:
```
bee1_cartographer/
‚îú‚îÄ‚îÄ üìÑ package.xml
‚îú‚îÄ‚îÄ üìÑ CMakeLists.txt
‚îú‚îÄ‚îÄ üìÑ README.md
‚îú‚îÄ‚îÄ üìÑ INSTALLATION_AND_USAGE.md
‚îú‚îÄ‚îÄ üìÇ include/bee1_cartographer/
‚îú‚îÄ‚îÄ üìÇ src/
‚îú‚îÄ‚îÄ üìÇ launch/
‚îú‚îÄ‚îÄ üìÇ config/
‚îú‚îÄ‚îÄ üìÇ urdf/
‚îú‚îÄ‚îÄ üìÇ scripts/
‚îú‚îÄ‚îÄ üìÇ docker/
‚îú‚îÄ‚îÄ üìÇ test/
‚îî‚îÄ‚îÄ üìÇ maps/
```

---

## 3. üõ†Ô∏è Donanƒ±m Konfig√ºrasyonu

### 3.1 Network Konfig√ºrasyonu (Velodyne VLP16)

```bash
# Static IP konfig√ºrasyonu
sudo nano /etc/netplan/01-network-manager-all.yaml
```

≈ûu konfig√ºrasyonu ekleyin:
```yaml
network:
  version: 2
  renderer: NetworkManager
  ethernets:
    eth0:  # veya ilgili ethernet interface
      dhcp4: false
      addresses:
        - 192.168.1.100/24
      nameservers:
        addresses: [8.8.8.8, 8.8.4.4]
```

```bash
# Network deƒüi≈üikliklerini uygula
sudo netplan apply

# VLP16 baƒülantƒ±sƒ±nƒ± test et (VLP16 IP: 192.168.1.201)
ping 192.168.1.201
```

### 3.2 UDEV Rules Kurulumu

```bash
# USB cihazlar i√ßin udev rules kur
sudo cp ~/bee1_cartographer_ws/src/bee1_cartographer/config/udev/99-bee1-devices.rules /etc/udev/rules.d/
sudo udevadm control --reload-rules
sudo udevadm trigger

# Kullanƒ±cƒ±yƒ± dialout grubuna ekle
sudo usermod -a -G dialout $USER

# Logout/login gerekli veya:
newgrp dialout
```

### 3.3 CAN Bus Konfig√ºrasyonu (Opsiyonel)

```bash
# CAN utils kurulum
sudo apt install can-utils

# CAN interface kurulum
sudo modprobe can
sudo modprobe can_raw
sudo modprobe can_bcm

# can0 interface yapƒ±landƒ±rma
sudo ip link set can0 type can bitrate 500000
sudo ip link set up can0

# CAN bus test
cansend can0 123#DEADBEEF
candump can0
```

---

## 4. üèÉ Sistem √áalƒ±≈ütƒ±rma

### 4.1 Temel Sistem Ba≈ülatma

```bash
# Terminal 1: Hardware interface ba≈ülat
cd ~/bee1_cartographer_ws
source install/setup.bash
ros2 launch bee1_cartographer bee1_hardware.launch.py

# Terminal 2: Temel sistem (robot state, EKF, sens√∂rler)
ros2 launch bee1_cartographer bee1_bringup.launch.py
```

### 4.2 Haritalama Modu (ƒ∞lk Kullanƒ±m)

```bash
# Terminal 1: Temel sistem + hardware
ros2 launch bee1_cartographer bee1_hardware.launch.py

# Terminal 2: Haritalama ba≈ülat
ros2 launch bee1_cartographer bee1_mapping.launch.py

# Terminal 3: RViz ile g√∂rselle≈ütirme (otomatik a√ßƒ±lƒ±r)
# Manuel a√ßmak i√ßin:
# rviz2 -d ~/bee1_cartographer_ws/src/bee1_cartographer/config/rviz/bee1_mapping.rviz

# Terminal 4: Manuel kontrol (harita olu≈üturmak i√ßin)
ros2 run teleop_twist_keyboard teleop_twist_keyboard --ros-args --remap cmd_vel:=/cmd_vel
```

#### Haritayƒ± Kaydetme

```bash
# Harita kaydetme
mkdir -p ~/bee1_cartographer_ws/maps
cd ~/bee1_cartographer_ws/maps

# Cartographer'dan harita al
ros2 service call /write_state cartographer_ros_msgs/srv/WriteState \
  "{filename: '$(pwd)/bee1_track.pbstream'}"

# Navigation2 i√ßin yaml harita olu≈ütur
ros2 run nav2_map_server map_saver_cli -f bee1_track

# Dosya kontrol√º
ls -la bee1_track.*
# √áƒ±ktƒ±: bee1_track.pbstream, bee1_track.yaml, bee1_track.pgm
```

### 4.3 Lokalizasyon Modu

```bash
# √ñnceden kaydedilmi≈ü harita ile lokalizasyon
ros2 launch bee1_cartographer bee1_localization.launch.py \
  map:=~/bee1_cartographer_ws/maps/bee1_track.yaml

# ƒ∞lk pozisyon estimate (RViz'de "2D Pose Estimate" kullanƒ±n)
```

### 4.4 Navigasyon Modu (Otonom S√ºr√º≈ü)

```bash
# Terminal 1: Navigasyon sistemi ba≈ülat
ros2 launch bee1_cartographer bee1_navigation.launch.py \
  map:=~/bee1_cartographer_ws/maps/bee1_track.yaml

# Terminal 2: Mission executor ba≈ülat
ros2 run bee1_cartographer mission_executor

# Terminal 3: Vehicle controller ba≈ülat
ros2 run bee1_cartographer vehicle_controller

# Terminal 4: System monitor
ros2 run bee1_cartographer system_monitor
```

### 4.5 Tam Sistem (Production)

```bash
# Tek komutla t√ºm sistemi ba≈ülat
ros2 launch bee1_cartographer bee1_full_system.launch.py \
  map:=~/bee1_cartographer_ws/maps/bee1_track.yaml \
  use_sim_time:=false \
  autostart:=true

# Veya script ile
cd ~/bee1_cartographer_ws/src/bee1_cartographer/scripts
./launch_all.sh
```

---

## 5. üó∫Ô∏è Mission Planning

### 5.1 GeoJSON Waypoint Olu≈üturma

√ñrnek GeoJSON formatƒ±:
```json
{
    "type": "FeatureCollection",
    "crs": {
        "type": "name",
        "properties": {
            "name": "EPSG:4326"
        }
    },
    "features": [
        {
            "type": "Feature",
            "properties": {
                "name": "start_point",
                "local_x": 0.0,
                "local_y": 0.0,
                "heading": 0.0,
                "speed": 5.0,
                "stop_duration": 0.0
            },
            "geometry": {
                "type": "Point",
                "coordinates": [29.50896659, 40.7903314]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "waypoint_1",
                "local_x": 50.0,
                "local_y": 0.0,
                "heading": 90.0,
                "speed": 10.0,
                "stop_duration": 2.0
            },
            "geometry": {
                "type": "Point",
                "coordinates": [29.50946659, 40.7903314]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "waypoint_2",
                "local_x": 50.0,
                "local_y": 50.0,
                "heading": 180.0,
                "speed": 15.0,
                "stop_duration": 1.0
            },
            "geometry": {
                "type": "Point",
                "coordinates": [29.50946659, 40.7908314]
            }
        },
        {
            "type": "Feature",
            "properties": {
                "name": "finish_point",
                "local_x": 0.0,
                "local_y": 50.0,
                "heading": 270.0,
                "speed": 5.0,
                "stop_duration": 5.0
            },
            "geometry": {
                "type": "Point",
                "coordinates": [29.50896659, 40.7908314]
            }
        }
    ]
}
```

### 5.2 Mission Y√ºkleme ve Ba≈ülatma

```bash
# GeoJSON dosyasƒ±nƒ± kaydet
nano ~/bee1_cartographer_ws/maps/mission_track.geojson
# Yukarƒ±daki JSON i√ßeriƒüini yapƒ±≈ütƒ±r

# Mission y√ºkle
ros2 service call /geojson_parser/load_mission \
  bee1_interfaces/srv/LoadMission \
  "{mission_file: '/home/$USER/bee1_cartographer_ws/maps/mission_track.geojson'}"

# Mission durumunu kontrol et
ros2 topic echo /mission_status

# Mission ba≈ülat
ros2 service call /mission_executor/start_mission std_srvs/srv/Empty

# Mission durdur (emergency)
ros2 service call /mission_executor/stop_mission std_srvs/srv/Empty

# Mission sƒ±fƒ±rla
ros2 service call /mission_executor/reset_mission std_srvs/srv/Empty
```

---

## 6. üê≥ Docker Kullanƒ±mƒ±

### 6.1 Docker Image Build

```bash
cd ~/Bee1-SLAM

# Development image
docker build -t bee1-slam:dev .

# Production image
docker build -t bee1-slam:prod -f docker/Dockerfile.prod .

# Multi-architecture build
docker buildx build --platform linux/amd64,linux/arm64 -t bee1-slam:latest .
```

### 6.2 Development Container

```bash
# X11 forwarding ile GUI desteƒüi
xhost +local:docker

# Development container √ßalƒ±≈ütƒ±r
docker run -it --rm \
  --privileged \
  --network host \
  --ipc host \
  -v /tmp/.X11-unix:/tmp/.X11-unix \
  -v $HOME/bee1_cartographer_ws:/workspace \
  -v /dev:/dev \
  -e DISPLAY=$DISPLAY \
  -e ROS_DOMAIN_ID=0 \
  --name bee1-dev \
  bee1-slam:dev
```

### 6.3 Production Container

```bash
# Production container (daemon mode)
docker run -d \
  --restart unless-stopped \
  --privileged \
  --network host \
  --ipc host \
  -v /dev:/dev \
  -v $HOME/bee1_maps:/workspace/maps \
  -v $HOME/bee1_logs:/workspace/logs \
  -e ROS_DOMAIN_ID=0 \
  --name bee1-prod \
  bee1-slam:prod \
  ros2 launch bee1_cartographer bee1_full_system.launch.py

# Container durumu
docker ps
docker logs bee1-prod

# Container'a baƒülan
docker exec -it bee1-prod bash
```

### 6.4 Docker Compose

```bash
cd ~/Bee1-SLAM

# Servisleri ba≈ülat
docker-compose up -d

# Specific service ba≈ülat
docker-compose up bee1-mapping

# Loglarƒ± takip et
docker-compose logs -f

# Servisleri durdur
docker-compose down

# Volume'larƒ± da sil
docker-compose down -v
```

---

## 7. üìä Sistem Monitoring

### 7.1 Temel Durum Kontrolleri

```bash
# T√ºm ROS2 node'larƒ±nƒ± listele
ros2 node list

# Bee1 √∂zel node'larƒ± kontrol
ros2 node list | grep bee1

# Node detaylarƒ±
ros2 node info /geojson_parser
ros2 node info /mission_executor
ros2 node info /vehicle_controller
ros2 node info /hardware_interface
ros2 node info /system_monitor

# Topic listesi
ros2 topic list

# Service listesi
ros2 service list
```

### 7.2 Sens√∂r Durumu Monitoring

```bash
# GPS durumu
ros2 topic echo /ublox_gps/fix --once
ros2 topic echo /ublox_gps/navstatus --once

# IMU durumu
ros2 topic echo /imu/data --once

# LiDAR durumu
ros2 topic echo /velodyne_points --once
ros2 topic hz /velodyne_points

# Velodyne diagnostics
ros2 topic echo /velodyne_driver/diagnostics

# EKF filtered odometry
ros2 topic echo /odometry/filtered --once

# GPS-EKF status
ros2 topic echo /diagnostics | grep -A 10 robot_localization
```

### 7.3 SLAM ve Navigation Monitoring

```bash
# Cartographer map data
ros2 topic echo /map --once
ros2 topic hz /scan

# Transform tree kontrol
ros2 run tf2_tools view_frames
# √áƒ±ktƒ±: frames.pdf dosyasƒ± olu≈üur

# TF echo test
ros2 run tf2_ros tf2_echo map base_link
ros2 run tf2_ros tf2_echo base_link velodyne

# Navigation durumu
ros2 topic echo /amcl_pose --once
ros2 topic echo /global_costmap/costmap --once
ros2 topic echo /local_costmap/costmap --once
ros2 topic echo /plan --once

# Mission status
ros2 topic echo /mission_status
ros2 topic echo /waypoints
```

### 7.4 Vehicle Control Monitoring

```bash
# Vehicle diagnostics
ros2 topic echo /vehicle/diagnostics

# Control commands
ros2 topic echo /cmd_vel

# Ackermann commands
ros2 topic echo /ackermann_cmd

# Emergency stop status
ros2 topic echo /emergency_stop

# Manual override status
ros2 topic echo /manual_override

# System health
ros2 topic echo /system/warnings
ros2 topic echo /system/errors
```

### 7.5 Performance Monitoring

```bash
# CPU ve Memory kullanƒ±mƒ±
htop
sudo iotop

# ROS2 specific monitoring
ros2 run rqt_graph rqt_graph
ros2 run rqt_plot rqt_plot

# Network monitoring
sudo nethogs
iftop

# GPU monitoring (NVIDIA)
watch -n 1 nvidia-smi

# Disk I/O
iostat -x 1
```

---

## 8. üîß Konfig√ºrasyon D√ºzenleme

### 8.1 Ana Parametre Dosyasƒ±

```bash
# Sistem parametrelerini d√ºzenle
nano ~/bee1_cartographer_ws/src/bee1_cartographer/config/bee1_params.yaml
```

√ñnemli parametreler:
```yaml
bee1:
  # Vehicle specifications
  max_linear_velocity: 15.0    # m/s (55 km/h)
  max_angular_velocity: 1.0    # rad/s
  wheelbase: 1.86              # meters
  
  # Safety limits
  emergency_stop_enabled: true
  manual_override_enabled: true
  speed_limit_enabled: true
  
  # Sensor configuration
  use_gps: true
  use_imu: true
  use_lidar: true
  
  # Navigation
  goal_tolerance: 0.5          # meters
  path_lookahead: 2.0          # meters
```

### 8.2 Cartographer Ayarlarƒ±

```bash
# 2D SLAM parametreleri d√ºzenle
nano ~/bee1_cartographer_ws/src/bee1_cartographer/config/cartographer/bee1_2d.lua
```

### 8.3 Navigation2 Ayarlarƒ±

```bash
# Nav2 controller parametreleri
nano ~/bee1_cartographer_ws/src/bee1_cartographer/config/navigation/nav2_params.yaml
```

### 8.4 Robot Localization (EKF) Ayarlarƒ±

```bash
# GPS+IMU fusion parametreleri
nano ~/bee1_cartographer_ws/src/bee1_cartographer/config/robot_localization/ekf.yaml
```

### 8.5 Velodyne VLP16 Konfig√ºrasyonu

```bash
# LiDAR kalibrasyonu
nano ~/bee1_cartographer_ws/src/bee1_cartographer/config/VLP16db.yaml

# Network ayarlarƒ±
nano ~/bee1_cartographer_ws/src/bee1_cartographer/config/network/velodyne-network.yaml
```

---

## 9. üêõ Troubleshooting

### 9.1 Kurulum Sorunlarƒ±

**ROS2 kurulum hatalarƒ±:**
```bash
# GPG key hatasƒ±
sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys F42ED6FBAB17C654

# Repository g√ºncelleme
sudo apt update --fix-missing

# Broken packages
sudo apt --fix-broken install
```

**Dependencies hatasƒ±:**
```bash
# rosdep g√ºncelleme
rosdep update --include-eol-distros

# Force install
rosdep install --from-paths src --ignore-src -r -y --skip-keys="geographic_msgs"
```

**Build hatalarƒ±:**
```bash
# Clean build
cd ~/bee1_cartographer_ws
rm -rf build install log
colcon build --symlink-install --cmake-args -DCMAKE_BUILD_TYPE=Release

# Verbose build
colcon build --event-handlers console_direct+
```

### 9.2 Donanƒ±m Sorunlarƒ±

**GPS baƒülantƒ± problemi:**
```bash
# USB device kontrol
lsusb | grep u-blox

# Serial port kontrol
sudo dmesg | grep tty

# GPS status test
ros2 topic echo /ublox_gps/fix --once

# GPS restart
sudo systemctl restart gpsd
```

**LiDAR baƒülantƒ± problemi:**
```bash
# Network interface kontrol
ip addr show

# VLP16 ping test
ping 192.168.1.201

# Port listening test
sudo netstat -tulpn | grep 2368

# Velodyne driver restart
ros2 lifecycle set /velodyne_driver deactivate
ros2 lifecycle set /velodyne_driver activate
```

**IMU baƒülantƒ± problemi:**
```bash
# USB cihaz kontrol
lsusb | grep Xsens

# Permission kontrol
ls -la /dev/ttyUSB*

# IMU test
ros2 topic echo /imu/data --once

# UDEV rules yeniden y√ºkle
sudo udevadm control --reload-rules
sudo udevadm trigger
```

### 9.3 SLAM Sorunlarƒ±

**Cartographer ba≈ülamƒ±yor:**
```bash
# TF tree kontrol
ros2 run tf2_tools view_frames

# Scan data kontrol
ros2 topic echo /scan --once

# Cartographer restart
ros2 lifecycle set /cartographer_node deactivate
ros2 lifecycle set /cartographer_node activate
```

**Haritalama kalitesi d√º≈ü√ºk:**
```bash
# Scan frequency kontrol
ros2 topic hz /scan

# Odometry kontrol
ros2 topic echo /odom --once

# Cartographer status
ros2 topic echo /cartographer/trajectory_node_list
```

### 9.4 Navigation Sorunlarƒ±

**AMCL lokalizasyon problemi:**
```bash
# Initial pose set
ros2 topic pub /initialpose geometry_msgs/msg/PoseWithCovarianceStamped \
  "{header: {frame_id: 'map'}, pose: {pose: {position: {x: 0.0, y: 0.0}, orientation: {w: 1.0}}}}" --once

# AMCL restart
ros2 lifecycle set /amcl deactivate
ros2 lifecycle set /amcl activate

# Particle cloud kontrol
ros2 topic echo /particle_cloud --once
```

**Navigation goal ula≈üamƒ±yor:**
```bash
# Costmap temizle
ros2 service call /local_costmap/clear_entirely_local_costmap nav2_msgs/srv/ClearEntireCostmap
ros2 service call /global_costmap/clear_entirely_global_costmap nav2_msgs/srv/ClearEntireCostmap

# Path planner restart
ros2 lifecycle set /planner_server deactivate
ros2 lifecycle set /planner_server activate

# Controller restart
ros2 lifecycle set /controller_server deactivate
ros2 lifecycle set /controller_server activate
```

### 9.5 Mission Execution Sorunlarƒ±

**GeoJSON parser hatasƒ±:**
```bash
# JSON format kontrol
python3 -m json.tool ~/bee1_cartographer_ws/maps/mission_track.geojson

# Mission reload
ros2 service call /geojson_parser/reload std_srvs/srv/Empty

# Parser restart
ros2 run bee1_cartographer geojson_parser --ros-args --log-level DEBUG
```

**Vehicle control yanƒ±t vermiyor:**
```bash
# Emergency stop kontrol√º
ros2 topic echo /emergency_stop --once

# Manual override kontrol√º
ros2 topic echo /manual_override --once

# Vehicle controller restart
ros2 run bee1_cartographer vehicle_controller --ros-args --log-level DEBUG

# CAN bus kontrol (eƒüer kullanƒ±lƒ±yorsa)
candump can0
```

### 9.6 Performance Sorunlarƒ±

**Y√ºksek CPU kullanƒ±mƒ±:**
```bash
# ROS2 process monitoring
top -p $(pgrep -f ros2)

# Sensor frequency d√º≈ü√ºr
ros2 param set /velodyne_driver frequency 5.0

# Cartographer resolution artƒ±r
# bee1_2d.lua dosyasƒ±nda resolution deƒüerini 0.05'ten 0.1'e √ßƒ±kar
```

**Memory leak:**
```bash
# Memory monitoring
watch -n 1 'free -h && ps aux --sort=-%mem | head -20'

# ROS2 daemon restart
ros2 daemon stop
ros2 daemon start

# System memory temizle
sudo sysctl -w vm.drop_caches=3
```

### 9.7 Network Sorunlarƒ±

**ROS2 discovery problemi:**
```bash
# ROS_DOMAIN_ID kontrol
echo $ROS_DOMAIN_ID

# Network discovery test
ros2 multicast receive
ros2 multicast send

# DDS config
export RMW_IMPLEMENTATION=rmw_cyclonedx_cpp
export CYCLONEDX_URI=file:///path/to/cyclonedx.xml
```

---

## 10. üß™ Test ve Doƒürulama

### 10.1 Birim Testleri

```bash
cd ~/bee1_cartographer_ws

# Python testleri √ßalƒ±≈ütƒ±r
python3 src/bee1_cartographer/test/test_basic_functionality.py

# ROS2 testleri
colcon test --packages-select bee1_cartographer
colcon test-result --verbose
```

### 10.2 Entegrasyon Testleri

```bash
# Sensor integration test
ros2 launch bee1_cartographer test_sensors.launch.py

# Navigation stack test
ros2 launch bee1_cartographer test_navigation.launch.py

# Full system test
ros2 launch bee1_cartographer test_full_system.launch.py
```

### 10.3 Sim√ºlasyon Testleri

```bash
# Gazebo sim√ºlasyonu
ros2 launch bee1_cartographer bee1_simulation.launch.py

# Sim√ºlasyon ile navigation test
ros2 launch bee1_cartographer bee1_sim_navigation.launch.py
```

### 10.4 Hardware-in-the-Loop Test

```bash
# Ger√ßek sens√∂rler + sim√ºlasyon environment
ros2 launch bee1_cartographer bee1_hil_test.launch.py

# Performance benchmark
ros2 run bee1_cartographer performance_benchmark
```

---

## 11. üîß Makefile Kullanƒ±mƒ±

```bash
cd ~/bee1_cartographer_ws/src/bee1_cart
